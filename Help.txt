
# ğŸ§© HELP.txt  
## PROJETO: Monitoramento â€” Node.js + Prometheus + Grafana + NGINX + Kubernetes (Minikube)

---

## ğŸ“˜ DESCRIÃ‡ÃƒO GERAL

Este projeto implementa um ambiente completo de **monitoramento de uma aplicaÃ§Ã£o Node.js** dentro do **Kubernetes (via Minikube)**.  
O sistema conta com:
- **Node.js (Backend)** â†’ Gera uma mÃ©trica personalizada `app_request_total` acessÃ­vel em `/metrics`
- **Prometheus** â†’ Coleta mÃ©tricas da aplicaÃ§Ã£o
- **Grafana** â†’ Cria dashboards a partir das mÃ©tricas coletadas
- **NGINX (proxy reverso)** â†’ Faz o redirecionamento de requisiÃ§Ãµes HTTP
- **Kubernetes + Minikube** â†’ Orquestra todos os containers e serviÃ§os

---

## ğŸ§° PRÃ‰-REQUISITOS

Antes de rodar o projeto em outra mÃ¡quina, Ã© necessÃ¡rio:

1. **Instalar o Docker Desktop**
   - https://www.docker.com/products/docker-desktop/
   - Ativar o **WSL2** (no Windows)

2. **Instalar o Minikube**
   - https://minikube.sigs.k8s.io/docs/start/
   - Testar a instalaÃ§Ã£o:
     ```bash
     minikube version
     ```

3. **Instalar o Kubectl**
   - https://kubernetes.io/docs/tasks/tools/
   - Testar:
     ```bash
     kubectl version --client
     ```

4. **Node.js e NPM** (para testar o backend separadamente, se quiser)
   - https://nodejs.org/en/
   - Testar:
     ```bash
     node -v
     npm -v
     ```

---

## âš™ï¸ ESTRUTURA DO PROJETO

```
Adrian/
â”‚
â”œâ”€â”€ server.js                # Backend Node.js com mÃ©trica personalizada
â”œâ”€â”€ package.json             # DependÃªncias do projeto Node
â”‚
â”œâ”€â”€ nginx/
â”‚   â”œâ”€â”€ default.conf         # ConfiguraÃ§Ã£o do proxy reverso NGINX
â”‚   â””â”€â”€ Dockerfile           # CriaÃ§Ã£o da imagem do NGINX
â”‚
â”œâ”€â”€ k8s/
â”‚   â”œâ”€â”€ node-deployment.yaml # Deployment e Service do Node.js
â”‚   â”œâ”€â”€ prometheus.yaml      # ConfiguraÃ§Ã£o do Prometheus
â”‚   â”œâ”€â”€ prometheus-deployment.yaml
â”‚   â”œâ”€â”€ grafana-deployment.yaml
â”‚   â”œâ”€â”€ nginx-deployment.yaml
â”‚   â””â”€â”€ nginx-service.yaml
â”‚
â””â”€â”€ HELP.txt                 # Este arquivo de instruÃ§Ãµes
```

---

## ğŸš€ PASSO A PASSO PARA EXECUTAR

### 1ï¸âƒ£ Iniciar o Minikube
```powershell
minikube start --driver=docker
```

### 2ï¸âƒ£ Conectar o Docker local ao Minikube
```powershell
& minikube -p minikube docker-env | Invoke-Expression
```

### 3ï¸âƒ£ Construir a imagem do backend Node.js
```powershell
docker build -t monitoramento-back ./back
docker images
```

### 4ï¸âƒ£ Aplicar os manifests do Kubernetes
```powershell
kubectl apply -f ./k8s/
```

### 5ï¸âƒ£ Verificar se os pods estÃ£o ativos
```powershell
kubectl get pods
```

### 6ï¸âƒ£ Acessar os serviÃ§os

| ServiÃ§o        | Comando para abrir | Porta / Caminho |
|----------------|-------------------|----------------|
| **Node.js (backend)** | `minikube service node-service` | `/` e `/metrics` |
| **Prometheus** | `minikube service prometheus-service` | Porta 9090 |
| **Grafana** | `minikube service grafana-service` | Porta 3000 |
| **NGINX** | `minikube service nginx-service` | Porta 8080 |

### 7ï¸âƒ£ Validar MÃ©trica no Prometheus
```
app_request_total{instance="node-service:3123", job="node-app"}
```

### 8ï¸âƒ£ Criar Dashboard no Grafana
1. Acesse o Grafana (`minikube service grafana-service`)
2. Login padrÃ£o:
   ```
   UsuÃ¡rio: admin
   Senha: admin
   ```
3. VÃ¡ em **Connections â†’ Data Sources â†’ Add data source â†’ Prometheus**
4. Configure o campo **URL** como:
   ```
   http://prometheus-service:9090
   ```
5. Clique em **Save & Test**

Crie um painel:
- **New Dashboard â†’ Add Visualization**
- **Data source:** Prometheus  
- **Query:** `app_request_total`
- **VisualizaÃ§Ã£o:** Time series
- **TÃ­tulo:** â€œRequisiÃ§Ãµes Processadas (Node.js)â€

---

## ğŸ§± COMO FUNCIONA CADA COMPONENTE

### ğŸŸ© Node.js
Servidor backend com rota `/metrics`, expondo mÃ©tricas Prometheus.

### ğŸŸ¨ Prometheus
LÃª o `prometheus.yml` e coleta as mÃ©tricas do `node-service`.

### ğŸŸ¦ Grafana
Conecta-se ao Prometheus e gera visualizaÃ§Ãµes.

### ğŸŸ¥ NGINX
Proxy reverso redirecionando `/` para o backend Node.js.

---

## ğŸ”„ COMO RODAR EM OUTRA MÃQUINA (RESUMO)

```bash
minikube start --driver=docker
& minikube -p minikube docker-env | Invoke-Expression
docker build -t monitoramento-back ./back
kubectl apply -f ./k8s/
```

Acesse:
- Node.js â†’ `minikube service node-service`
- Prometheus â†’ `minikube service prometheus-service`
- Grafana â†’ `minikube service grafana-service`
- NGINX â†’ `minikube service nginx-service`

---

## âœ… RESULTADO FINAL

- O **Grafana** exibe o grÃ¡fico `app_request_total` com requisiÃ§Ãµes do Node.js.  
- O **Prometheus** coleta mÃ©tricas automaticamente.  
- O **NGINX** atua como proxy reverso.  
- Tudo roda dentro do **Minikube**, simulando um cluster real.
